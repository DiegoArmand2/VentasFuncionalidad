<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="Rptc_InterestCollection" pageWidth="842" pageHeight="595" orientation="Landscape" columnWidth="782" leftMargin="30" rightMargin="30" topMargin="20" bottomMargin="20" uuid="53b56dea-77d5-4cb2-b7c0-c9f2a60ca7e2">
	<property name="ireport.zoom" value="1.2396694214876152"/>
	<property name="ireport.x" value="149"/>
	<property name="ireport.y" value="0"/>
	<property name="ireport.scriptlethandling" value="0"/>
	<property name="ireport.encoding" value="UTF-8"/>
	<property name="net.sf.jasperreports.export.xls.detect.cell.type" value="true"/>
	<import value="net.sf.jasperreports.engine.*"/>
	<import value="org.openbravo.dal.core.OBContext"/>
	<import value="java.util.*"/>
	<import value="net.sf.jasperreports.engine.data.*"/>
	<parameter name="NUMBERFORMAT" class="java.text.DecimalFormat" isForPrompting="false">
		<defaultValueExpression><![CDATA[new DecimalFormat("###,##0.00;-###,##0.00", new DecimalFormatSymbols())]]></defaultValueExpression>
	</parameter>
	<parameter name="NUMBERDECIMAL" class="java.lang.Integer" isForPrompting="false">
		<defaultValueExpression><![CDATA[2]]></defaultValueExpression>
	</parameter>
	<parameter name="ad_org_id" class="java.lang.String"/>
	<parameter name="Dateto" class="java.util.Date"/>
	<parameter name="c_bpartner_id" class="java.lang.String"/>
	<parameter name="ad_user_id" class="java.lang.String"/>
	<parameter name="Org_ID" class="java.lang.String" isForPrompting="false">
		<defaultValueExpression><![CDATA[OBContext.getOBContext().getCurrentOrganization().getId()]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[select to_char($P{Dateto}::date,'dd/MM/yyyy') as fhasta,
TO_CHAR(now(),'dd/MM/yyyy HH24:MI:SS') "fecha_impresion",
(select coalesce(to_char(cbp.name), to_char(au.name)) from ad_user au left join c_bpartner cbp on cbp.c_bpartner_id = au.c_bpartner_id where au.ad_user_id = $P{ad_user_id}) AS "usuario",
case when $P{c_bpartner_id} is null then 'CLIENTE : TODOS' else (select 'CLIENTE: ' || name from c_bpartner where c_bpartner_id = $P{c_bpartner_id}) end  as clientefiltro,
c.name as organizationname,
d.name as partner,
e.documentno as documentno,
TO_DATE(a.dateinvoiced ::date,'dd/MM/yyyy') as dateinvoice,
coalesce(a.shareno, 0) as cuotano,
a.duedate,
to_date(to_char(a.Lastpaymentdate, 'YYYY-MM-DD'), 'YYYY-MM-DD') as Lastpaymentdatefilter ,
a.TCollectionExpenses,
a.TInterestLatePayment
from ssdnid_pendinginterest a
left join ssdnid_pendinginterest_v b on b.c_bpartner_id = a.c_bpartner_id
left join ad_org c on c.ad_org_id = a.ad_org_id
left join c_bpartner d on d.c_bpartner_id = a.c_bpartner_id
left join c_invoice e on e.c_invoice_id = a.c_invoice_id
where (a.c_bpartner_id = '699F3EF34D584C6B80E4A1ECECE49021' or $P{c_bpartner_id} is null)
and a.Debitnote_ID is null and a.FIN_Payment_ID is null
and to_date(to_char(a.Lastpaymentdate, 'YYYY-MM-DD'), 'YYYY-MM-DD') <= $P{Dateto}
and ad_isorgincluded(c.ad_org_id, $P{ad_org_id}, a.ad_client_id) > 0
and ($P{c_bpartner_id} is null or a.c_bpartner_id = $P{c_bpartner_id})
order by a.duedate]]>
	</queryString>
	<field name="fhasta" class="java.lang.String"/>
	<field name="fecha_impresion" class="java.lang.String"/>
	<field name="usuario" class="java.lang.String"/>
	<field name="clientefiltro" class="java.lang.String"/>
	<field name="organizationname" class="java.lang.String"/>
	<field name="partner" class="java.lang.String"/>
	<field name="documentno" class="java.lang.String"/>
	<field name="dateinvoice" class="java.sql.Timestamp"/>
	<field name="cuotano" class="java.math.BigDecimal"/>
	<field name="duedate" class="java.sql.Timestamp"/>
	<field name="lastpaymentdatefilter" class="java.sql.Date"/>
	<field name="tcollectionexpenses" class="java.math.BigDecimal"/>
	<field name="tinterestlatepayment" class="java.math.BigDecimal"/>
	<variable name="totalfactura" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[]]></variableExpression>
	</variable>
	<variable name="totalmora" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{tcollectionexpenses}]]></variableExpression>
	</variable>
	<variable name="totalcob" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{tinterestlatepayment}]]></variableExpression>
	</variable>
	<title>
		<band height="62" splitType="Stretch">
			<staticText>
				<reportElement key="staticText-1" x="105" y="0" width="535" height="32" uuid="cc590aa6-e22e-40b3-b4e8-245d4dcb2ff5"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="SansSerif" size="12" isBold="true" pdfFontName="Helvetica-Bold"/>
				</textElement>
				<text><![CDATA[MORA Y COBRANZA PENDIENTE]]></text>
			</staticText>
			<textField pattern="yyyy/MM/dd">
				<reportElement x="105" y="32" width="535" height="15" uuid="efcfb835-8bf6-4809-8178-7cf815f73106"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" markup="html">
					<font fontName="SansSerif" size="9" isBold="false"/>
				</textElement>
				<textFieldExpression><![CDATA["<b>A la  fecha:</b> "+$F{fhasta}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="105" y="47" width="535" height="15" uuid="4749f466-8082-485c-850c-f311154e0f61"/>
				<textElement textAlignment="Center">
					<font fontName="SansSerif" size="9" isBold="true" isItalic="false" isStrikeThrough="false"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{clientefiltro}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="640" y="0" width="142" height="62" uuid="bdac17af-dc3b-43cf-9d40-aef07406e80f"/>
				<textElement markup="html">
					<font fontName="SansSerif" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA["<b>Fecha de Impresi√≥n: </b><br>"+$F{fecha_impresion}
+"<br><b>Usuario: </b><br>"+$F{usuario}]]></textFieldExpression>
			</textField>
			<image hAlign="Center" vAlign="Middle">
				<reportElement x="0" y="0" width="105" height="62" uuid="48d39f09-8134-4b0e-8c7b-7a0530b6c80e"/>
				<box>
					<bottomPen lineWidth="0.5"/>
				</box>
				<imageExpression><![CDATA[org.openbravo.erpCommon.utility.Utility.showImageLogo("yourcompanylegal",$P{Org_ID})]]></imageExpression>
			</image>
		</band>
	</title>
	<pageHeader>
		<band height="34" splitType="Stretch">
			<staticText>
				<reportElement key="staticText-2" x="364" y="0" width="75" height="33" uuid="9159b7c5-b9ff-4eea-8d6f-0bea9111e825"/>
				<box>
					<topPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="SansSerif" size="10" isBold="true"/>
				</textElement>
				<text><![CDATA[FECHA FACTURA]]></text>
			</staticText>
			<staticText>
				<reportElement key="staticText-2" x="274" y="0" width="90" height="33" uuid="04f69ecf-bedf-488f-82d5-993ff485dfb6"/>
				<box>
					<topPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="SansSerif" size="10" isBold="true"/>
				</textElement>
				<text><![CDATA[FACTURA]]></text>
			</staticText>
			<staticText>
				<reportElement key="staticText-2" x="105" y="0" width="169" height="33" uuid="47943478-4c0a-49f9-b854-c8acc84d2243"/>
				<box>
					<topPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="SansSerif" size="10" isBold="true"/>
				</textElement>
				<text><![CDATA[CLIENTE]]></text>
			</staticText>
			<staticText>
				<reportElement key="staticText-2" x="0" y="0" width="105" height="33" uuid="b55a58f3-854c-4aaf-882c-0f30e752cfc7"/>
				<box>
					<topPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="SansSerif" size="10" isBold="true"/>
				</textElement>
				<text><![CDATA[LOCAL]]></text>
			</staticText>
			<staticText>
				<reportElement key="staticText-2" x="439" y="0" width="51" height="33" uuid="7e931224-2d2e-422f-99fa-dfdfe613bc17"/>
				<box>
					<topPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="SansSerif" size="10" isBold="true"/>
				</textElement>
				<text><![CDATA[# DE CUOTA]]></text>
			</staticText>
			<staticText>
				<reportElement key="staticText-2" x="490" y="0" width="75" height="33" uuid="9c478123-f4d8-46bb-b1bb-f7531b463206"/>
				<box>
					<topPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="SansSerif" size="10" isBold="true"/>
				</textElement>
				<text><![CDATA[FECHA DE VENCIMIENTO]]></text>
			</staticText>
			<staticText>
				<reportElement key="staticText-2" x="565" y="0" width="75" height="33" uuid="a9eb0e07-28a6-4817-b15e-74fe03c099ef"/>
				<box>
					<topPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="SansSerif" size="10" isBold="true"/>
				</textElement>
				<text><![CDATA[FECHA ULT PAGO]]></text>
			</staticText>
			<staticText>
				<reportElement key="staticText-2" x="640" y="0" width="71" height="33" uuid="2590ac0b-c421-4a65-bd5b-e823420dc888"/>
				<box>
					<topPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="SansSerif" size="10" isBold="true"/>
				</textElement>
				<text><![CDATA[MORA]]></text>
			</staticText>
			<staticText>
				<reportElement key="staticText-2" x="711" y="0" width="71" height="33" uuid="5a83ff51-cdc2-4efd-b591-5ac973f109c8"/>
				<box>
					<topPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="SansSerif" size="10" isBold="true"/>
				</textElement>
				<text><![CDATA[COBRANZA]]></text>
			</staticText>
		</band>
	</pageHeader>
	<detail>
		<band height="18" splitType="Stretch">
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement stretchType="RelativeToBandHeight" x="105" y="0" width="169" height="18" isRemoveLineWhenBlank="true" isPrintWhenDetailOverflows="true" uuid="dded3642-fee8-44d4-8ce6-d3911993e79a"/>
				<textElement textAlignment="Center" verticalAlignment="Top">
					<font fontName="SansSerif" size="9"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{partner}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement stretchType="RelativeToBandHeight" x="0" y="0" width="105" height="18" isRemoveLineWhenBlank="true" isPrintWhenDetailOverflows="true" uuid="12ec726e-5dab-47dd-9c60-f8cfe5dcfd2f"/>
				<textElement textAlignment="Center" verticalAlignment="Top">
					<font fontName="SansSerif" size="9"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{organizationname}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="" isBlankWhenNull="true">
				<reportElement stretchType="RelativeToBandHeight" x="274" y="0" width="90" height="18" isRemoveLineWhenBlank="true" isPrintWhenDetailOverflows="true" uuid="e6dde865-9a8a-4141-b639-fe496d0bf021"/>
				<textElement textAlignment="Center" verticalAlignment="Top">
					<font fontName="SansSerif" size="9"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{documentno}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="dd/MM/yyyy" isBlankWhenNull="true">
				<reportElement stretchType="RelativeToBandHeight" x="364" y="0" width="75" height="18" isRemoveLineWhenBlank="true" isPrintWhenDetailOverflows="true" uuid="2708bba1-9501-4c9c-95db-564ef79d8ada"/>
				<textElement textAlignment="Center" verticalAlignment="Top">
					<font fontName="SansSerif" size="9"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{dateinvoice}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement stretchType="RelativeToBandHeight" x="439" y="0" width="51" height="18" isRemoveLineWhenBlank="true" isPrintWhenDetailOverflows="true" uuid="58f0fd25-755c-43b0-bb3b-73c9bb9fb998"/>
				<textElement textAlignment="Center" verticalAlignment="Top">
					<font fontName="SansSerif" size="9"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{cuotano}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="dd/MM/yyyy" isBlankWhenNull="true">
				<reportElement stretchType="RelativeToBandHeight" x="490" y="0" width="75" height="18" isRemoveLineWhenBlank="true" isPrintWhenDetailOverflows="true" uuid="1d5d3369-7fc0-4c2f-aae8-350b6372affd"/>
				<textElement textAlignment="Center" verticalAlignment="Top">
					<font fontName="SansSerif" size="9"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{duedate}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="dd/MM/yyyy" isBlankWhenNull="true">
				<reportElement stretchType="RelativeToBandHeight" x="565" y="0" width="75" height="18" isRemoveLineWhenBlank="true" isPrintWhenDetailOverflows="true" uuid="769caba0-9f49-4674-9ea4-0cc72a69cc86"/>
				<textElement textAlignment="Center" verticalAlignment="Top">
					<font fontName="SansSerif" size="9"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{lastpaymentdatefilter}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement stretchType="RelativeToBandHeight" x="640" y="0" width="71" height="18" isRemoveLineWhenBlank="true" isPrintWhenDetailOverflows="true" uuid="06c839d3-25ca-4b02-a838-0ba19fa7ad37"/>
				<textElement textAlignment="Left" verticalAlignment="Top">
					<font fontName="SansSerif" size="9"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{tcollectionexpenses}]]></textFieldExpression>
				<patternExpression><![CDATA[$P{NUMBERFORMAT}.toPattern()]]></patternExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement stretchType="RelativeToBandHeight" x="711" y="0" width="71" height="18" isRemoveLineWhenBlank="true" isPrintWhenDetailOverflows="true" uuid="b57122a5-efc5-4f03-8941-2bbd4ebb01f5"/>
				<textElement textAlignment="Left" verticalAlignment="Top">
					<font fontName="SansSerif" size="9"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{tinterestlatepayment}]]></textFieldExpression>
				<patternExpression><![CDATA[$P{NUMBERFORMAT}.toPattern()]]></patternExpression>
			</textField>
		</band>
	</detail>
	<summary>
		<band height="19" splitType="Stretch">
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement stretchType="RelativeToBandHeight" x="640" y="0" width="71" height="18" isRemoveLineWhenBlank="true" isPrintWhenDetailOverflows="true" uuid="c07f143c-7495-48a5-864a-7c542882db2f"/>
				<textElement textAlignment="Left" verticalAlignment="Top">
					<font fontName="SansSerif" size="9" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{totalmora}]]></textFieldExpression>
				<patternExpression><![CDATA[$P{NUMBERFORMAT}.toPattern()]]></patternExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement stretchType="RelativeToBandHeight" x="711" y="1" width="71" height="18" isRemoveLineWhenBlank="true" isPrintWhenDetailOverflows="true" uuid="2df4f3ff-01b7-43fe-8456-5f20dcaf0ecd"/>
				<textElement textAlignment="Left" verticalAlignment="Top">
					<font fontName="SansSerif" size="9" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{totalcob}]]></textFieldExpression>
				<patternExpression><![CDATA[$P{NUMBERFORMAT}.toPattern()]]></patternExpression>
			</textField>
		</band>
	</summary>
</jasperReport>
